---
import { createLink } from '../../utils/url';
import Icon from '../Icon.astro';

interface Props {
  title?: string;
  href?: string;
  icon?: string;
}

const { title, href, icon } = Astro.props;

const Tag = href ? 'a' : 'div';
const link = href ? createLink(href) : undefined;

// Check if icon is an Iconify name (contains :) or an emoji
const isIconifyIcon = icon?.includes(':');
---

<Tag
  href={link}
  class:list={["card-component", "group", { "cursor-pointer": href }]}
>
  {icon && (
    <div class="card-icon">
      {isIconifyIcon ? <Icon name={icon} size={24} /> : icon}
    </div>
  )}
  {title && <h3 class="card-title">{title}</h3>}
  <div class="card-body">
    <slot />
  </div>
  {href && (
    <div class="card-arrow">
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </div>
  )}
</Tag>

<style>
  @reference "../../styles/global.css";

  .card-component {
    @apply block not-prose p-5 rounded-lg border border-border bg-card my-6;
    @apply transition-colors duration-150;
    position: relative;
    text-decoration: none;
  }

  .card-component:hover {
    border-color: var(--primary-300);
    background: var(--accent);
    text-decoration: none;
  }

  :global(.dark) .card-component:hover {
    border-color: var(--primary-400);
  }

  .card-icon {
    @apply mb-3 w-10 h-10 rounded-lg flex items-center justify-center text-xl;
    @apply text-primary-600;
    background: var(--primary-50);
  }

  :global(.dark) .card-icon {
    @apply text-primary-400;
    background: var(--primary-100);
  }

  .card-title {
    @apply text-base font-semibold text-card-foreground mb-1.5;
  }

  .card-body {
    @apply text-muted-foreground text-sm leading-relaxed;
  }

  .card-arrow {
    @apply absolute right-4 top-1/2 -translate-y-1/2;
    @apply text-muted-foreground;
    @apply transition-colors duration-150;
  }

  .card-component:hover .card-arrow {
    @apply text-primary-500;
  }
</style>
